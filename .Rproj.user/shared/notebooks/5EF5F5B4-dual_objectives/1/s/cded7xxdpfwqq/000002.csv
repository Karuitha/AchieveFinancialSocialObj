"0","######################################"
"0","remove_outliers <- function(x, na.rm = TRUE, ...) {"
"0","  qnt <- quantile(x, probs=c(.10, .90), na.rm = na.rm, ...)"
"0","  H <- 1.5 * IQR(x, na.rm = na.rm)"
"0","  y <- x"
"0","  y[x < (qnt[1] - H)] <- NA"
"0","  y[x > (qnt[2] + H)] <- NA"
"0","  y"
"0","}"
"0",""
"0","### add mfiid, year, age, legal tradition, current legal status & finsoc"
"0","multinom_wins <- my_data %>% select(assets, stmktcap, pcrdbgdp, kkm, gdp_growth_annual, year)"
"0",""
"0","#######################################"
"0","multinom_wins <- sapply(multinom_wins, remove_outliers) %>% "
"0","  "
"0","  cbind(my_data %>% select(mfiid, year, finsoc, age, legal_tradition, currentlegalstatus)) %>% "
"0","  "
"0","  relocate(mfiid:currentlegalstatus)"
"0",""
"0","#########################################"
"0","## Regression"
"0","full_wins <- multinom_wins %>% multinom(finsoc ~ age + assets + stmktcap + pcrdbgdp + kkm + gdp_growth_annual + legal_tradition + currentlegalstatus + factor(year), data = .) "
"1","# weights: "
"1"," "
"1","140"
"1"," ("
"1",""
"1","102"
"1",""
"1"," variable)
"
"1","initial  value 6202.280972 
"
"1","iter  10 value 5646.606246
"
"1","iter  20 value 5419.574386
"
"1","iter  30 value 5266.183910
"
"1","iter  40 value 5233.682382
"
"1","iter  50 value 5230.091284
"
"1","iter  60 value 5229.488270
"
"1","iter  70 value 5228.551671
"
"1","iter  80 value 5227.853609
"
"1","iter  90 value 5227.052011
"
"1","iter 100 value 5226.540454
"
"1","final  value 5226.540454 
"
"1","stopped after 100 iterations
"
